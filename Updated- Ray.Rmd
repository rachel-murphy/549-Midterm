---
title: "Updated- Ray"
author: "Rachel Murphy"
date: "10/31/2021"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
phd <-read.csv("processed.heartdisease.txt")
phd1 <- phd
phd1$ca<-replace(phd1$ca,phd1$ca == "?",0.0)
phd1$thal<-replace(phd1$thal,phd1$thal == "?",3.0)
phd1$ca <- as.numeric(phd1$ca)
phd1$thal <- as.numeric(phd1$thal)
head(phd)
```
hi 
how are you?

```{r}
library("gplots")

pairs(phd1[,c("age", "trestbps", "chol", "oldpeak", "thalach", "ca")],
  panel = function (x, y, ...) {
    points(x, y, ...)
    abline(lm(y ~ x), col = "red", lwd=3)
    }, 
  pch = ".", cex = 5, upper.panel = NULL)
cor(phd1[,c("age", "trestbps", "chol", "oldpeak", "thalach", "ca")])
heatmap.2(cor(phd1[,c("age", "trestbps", "chol", "oldpeak", "thalach","ca")]), Rowv = FALSE, Colv = FALSE, dendrogram = "none", 
          cellnote = round(cor(phd1[,c("age", "trestbps", "chol", "oldpeak", "thalach", "ca")]),2), 
          notecol = "black", key = FALSE, trace = 'none',
          margins = c(6,6))
```

Note: continuous: age, oldpeak,chol, trestbps, thalach

```{r}

```


```{r}
library(ggplot2)
phd1$num <- as.factor(phd1$num)
phd1$sex <- as.factor(phd1$sex)
phd1$cp <- as.factor(phd1$cp)
phd1$fbs <- as.factor(phd1$fbs)
phd1$restecg <- as.factor(phd1$restecg)
phd1$exang <- as.factor(phd1$exang)
phd1$slope <- as.factor(phd1$slope)
phd1$ca <- as.factor(phd1$ca)
phd1$thal <- as.factor(phd1$thal)
qplot(age, chol, data = phd, color = num) #does not seem to hold an exact separation
qplot(age, trestbps, data = phd, color = num) #does not seem to hold an exact separation
qplot(age, oldpeak, data = phd, color = num) # does seem to hold a slight separation 
qplot(age, thalach, data = phd, color = num)
qplot(oldpeak, thalach, data = phd, color = num)
qplot(trestbps, thalach, data = phd, color = num)
```

```{r}

```


```{r}
cphd.pc <- princomp(phd[,c("age", "trestbps", "chol", "oldpeak", "thalach")], cor=T)
summary(cphd.pc, loadings=T)
```



```{r}
library("devtools")
devtools::install_github("sinhrks/ggfortify")
library(ggfortify)
ggplot2::autoplot(cphd.pc, label = TRUE, loadings.label = TRUE)
```

```{r}
library(cluster)

daisy(phd1, metric="gower")
```
