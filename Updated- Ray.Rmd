---
title: "Updated- Ray"
author: "Rachel Murphy"
date: "10/31/2021"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
phd <-read.csv("processed.heartdisease.txt")
phd1 <- phd
phd1$ca<-replace(phd1$ca,phd1$ca == "?","")
phd1$thal<-replace(phd1$thal,phd1$thal == "?","")
phd1$ca <- as.numeric(phd1$ca)
phd1$thal <- as.numeric(phd1$thal)
phd1 <- phd1 %>% mutate(pres = ifelse(num == 0,0,1))
head(phd1)
```
hi 
how are you?

```{r}
library("gplots")

pairs(phd1[,c("age", "trestbps", "chol", "oldpeak", "thalach")],
  panel = function (x, y, ...) {
    points(x, y, ...)
    abline(lm(y ~ x), col = "red", lwd=3)
    }, 
  pch = ".", cex = 5, upper.panel = NULL)
cor(phd1[,c("age", "trestbps", "chol", "oldpeak", "thalach")])
heatmap.2(cor(phd1[,c("age", "trestbps", "chol", "oldpeak", "thalach")]), Rowv = FALSE, Colv = FALSE, dendrogram = "none", 
          cellnote = round(cor(phd1[,c("age", "trestbps", "chol", "oldpeak", "thalach")]),2), 
          notecol = "black", key = FALSE, trace = 'none',
          margins = c(6,6))
```

Note: continuous: age, oldpeak,chol, trestbps, thalach

```{r}

```


```{r}
library(ggplot2)
phd1$pres <- as.factor(phd1$pres)
phd1$sex <- as.factor(phd1$sex)
phd1$cp <- as.factor(phd1$cp)
phd1$fbs <- as.factor(phd1$fbs)
phd1$restecg <- as.factor(phd1$restecg)
phd1$exang <- as.factor(phd1$exang)
phd1$slope <- as.factor(phd1$slope)
phd1$ca <- as.factor(phd1$ca)
phd1$thal <- as.factor(phd1$thal)
qplot(age, chol, data = phd1, color = pres) #does not seem to hold an exact separation
qplot(age, trestbps, data = phd1, color = pres) #does not seem to hold an exact separation
qplot(age, oldpeak, data = phd1, color = pres) # does seem to hold a slight separation 
qplot(age, thalach, data = phd1, color = pres)
qplot(oldpeak, thalach, data = phd1, color = pres)
qplot(trestbps, thalach, data = phd1, color = pres)
```

```{r}

```


```{r}
cphd.pc <- princomp(phd1[,c("age", "trestbps", "chol", "oldpeak", "thalach")], cor=T)
summary(cphd.pc, loadings=T)
```

```{r}
cphd.pc <- princomp(distmatrix, cor=T)
summary(cphd.pc, loadings=T)

```


```{r}
library("devtools")
devtools::install_github("sinhrks/ggfortify")
library(ggfortify)
ggplot2::autoplot(cphd.pc, label = TRUE, loadings.label = TRUE)
```

```{r}
library(cluster)

distmatrix <- scale(daisy(phd1[,-14], metric="gower"))

k<-kmeans(distmatrix, centers=2, iter.max=100, nstart=25)
```


```{r}
n <- nrow(distmatrix)
wss <- rep(0, 10)
wss[1] <- (n - 1) * sum(apply(distmatrix, 2,var))
for (i in 2:10){
  wss[i] <- sum(kmeans(distmatrix, centers = i, iter.max=100, nstart=25)$withinss)
  plot(1:10, wss, type = "b", xlab = "Number of clusters", ylab = "Within groups sum of squares")
}
```


```{r}
clusplot(distmatrix, phd1$pres, color=TRUE, shade=TRUE, 
    labels=2, lines=0, main = "Prescence and Absence Grouping")
```


